---
const SHEET_ID = '1nP83DprTj83JsV0fKSjSTkw4jxI99-Ha0bemI372iq8'; // Reemplaza con tu ID de Google Sheets
const API_KEY = 'AIzaSyB1F8PIVoZYypVWZhCoWYVkd39ISzwNbw0'; // Reemplaza con tu clave API
const RANGE = '1!A2:E20'; // El rango de tu hoja de cálculo

// Función para obtener los datos desde Google Sheets
async function obtenerDatos() {
  try {
    const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}?key=${API_KEY}`);
    const data = await response.json();
    
    // Verifica si 'values' existe en la respuesta
    if (!data.values) {
      throw new Error("No se encontraron datos en la respuesta.");
    }
    return data.values;
  } catch (error) {
    console.error("Error al obtener los datos:", error);
    return []; // Retorna un array vacío en caso de error
  }
}

// Obtener los datos en el servidor durante la construcción de la página
const datos = await obtenerDatos();
---

<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Obtener Datos de Google Sheets</title>
  </head>
  <body>
    <h1>Datos desde Google Sheets</h1>
    
    <div>
      <h2>Tabla de Datos</h2>
      <table border="1">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Email</th>
            <th>Teléfono</th>
            <th>Dirección</th>
          </tr>
        </thead>
        <tbody>
          {datos.length > 0 ? (
            datos.map(fila => (
              <tr>
                <td>{fila[0]}</td>
                <td>{fila[1]}</td>
                <td>{fila[2]}</td>
                <td>{fila[3]}</td>
                <td>{fila[4]}</td>
              </tr>
            ))
          ) : (
            <tr><td colspan="5">No se encontraron datos.</td></tr>
          )}
        </tbody>
      </table>
    </div>
  </body>
</html>
